# ioHeavyTC

## Test Case Description

`ioHeavyTC` is based on the IOHeavy benchmark in
[BlockBench](https://github.com/ooibc88/blockbench).

For your reference, the original description of IOHeavy benchmark in the SIGMOD
paper is like the below:
> Current blockchain systems rely on key-value storage to persist blockchain
> transactions and states. Each storage system may perform differently under
> different workloads. This workload is designed to evaluate the IO performance
> by invoking a contract that performs a large number of random writes and
> random reads to the contractâ€™s states. The I/O bandwidth can be estimated via
> the observed transaction latency.

Similarly to BlockBench's IOHeavy benchmark, `ioHeavyTC` evaluates the
performance of writing and reading Kaia's states, especially state variables
declared in a smart contract.  The `IOHeavy` smart contract in `IOHeavy.sol` is
used for testing, and its functions are tested through the following interface
implemented in `ioHeavyTC.go`.

| Function | Description |
| -------- | ----------- |
| `Write` | Call the `write` function, which performs multiple write operations against storage variables (actually a map), in the `IOHeavy` contract with a randomly chosen but a range-limited integer key, the number of keys, and a signature (or identifier) recorded in the event log |
| `Scan` | Call the `scan` function, which reads multiple storage variables (actually a map), in the `IOHeavy` contract with a range-limited integer key, the number of keys, and a signature (or identifier) recorded in the event log |
| `Run` | Randomly invoke one test function between `Write` and `Scan` |


## Source Files

This directory has the following source files.

- `IOHeavy.sol`: `IOHeavy` contract file written in solidity
   - Origin: https://github.com/ooibc88/blockbench/blob/master/benchmark/contracts/ethereum/ioheavy.sol
   - Updated the solidity version in the pragma statement to v0.4.24
   - Modified function signatures to suppress solc warnings
- `IOHeavy.go`: Go binding code generated by `abigen` using `go generate`
- `ioHeavyTC.go`: initialization and test functions (i.e., `Write`, `Scan`, and `Run`) implementation
   - Implemented test logics in [https://github.com/ooibc88/blockbench/tree/master/src/micro/ioheavy/ethereum](https://github.com/ooibc88/blockbench/tree/master/src/micro/ioheavy/ethereum)


## References

- [BlockBench github repository](https://github.com/ooibc88/blockbench)
- [BLOCKBENCH: A Framework for Analyzing Private Blockchains](https://dl.acm.org/citation.cfm?id=3064033), published in SIGMOD '17
